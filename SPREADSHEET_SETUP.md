# Google Spreadsheet ID の設定方法

## 📋 スプレッドシートIDの取得方法

### 方法1: URLから取得（最も簡単）

1. Google Spreadsheetを開く
2. ブラウザのアドレスバーを確認
3. URLの形式:
   ```
   https://docs.google.com/spreadsheets/d/[この部分がID]/edit
   ```
4. `/d/` と `/edit` の間の文字列がスプレッドシートIDです

**例**:
```
https://docs.google.com/spreadsheets/d/1wdH9PXo6cgzG258Dl_L4JmubYtSYe4V3ZruAim6KAOY/edit
                                    ↑この部分がID
```

### 方法2: 新しいスプレッドシートを作成

1. https://docs.google.com/spreadsheets にアクセス
2. 「空白」をクリックして新しいスプレッドシートを作成
3. 上記の方法1でIDを取得

---

## ⚙️ 設定方法

### 方法1: 設定画面から設定（推奨）

1. 「調査開始」タブを開く
2. 「設定（Google Spreadsheet ID等）」ボタンをクリック
3. 「Google Spreadsheet ID」にIDを入力
4. 「保存」をクリック

### 方法2: ワークフローフォームから設定

1. 「楽天商品調査を実行」ボタンをクリック
2. フォームの「Google Spreadsheet ID」フィールドにIDを入力
3. 調査を実行すると自動的に保存されます

---

## ✅ 設定の確認

設定後、以下の場所で確認できます:

1. **ブラウザの開発者ツール**:
   - F12キーを押す
   - 「Application」タブ → 「Local Storage」
   - `google_spreadsheet_id` の値を確認

2. **設定画面**:
   - 設定画面を開くと、現在の値が表示されます

---

## 🔧 必要な権限

### Google Spreadsheetの権限

- **読み取り権限**: データを表示するために必要
- **編集権限**: データを書き込むために必要（Google Apps Scriptを使用する場合）

### 権限の設定方法

1. Google Spreadsheetを開く
2. 「共有」ボタンをクリック
3. Google Apps Scriptを実行するアカウントに編集権限を付与

**注意**: Google Apps Scriptを使用する場合、スクリプトを実行するアカウントがスプレッドシートの編集権限を持っている必要があります。

---

## 📝 スプレッドシートの準備

### 推奨設定

1. **シート名**: `Sheet1`（デフォルト）
2. **列の準備**: 自動的にヘッダーが書き込まれますが、事前に準備する必要はありません
3. **A列**: 使用しない（B列から開始）

### データ形式

書き込まれるデータ:
- **B列**: 検索順位
- **C列**: 商品名
- **D列**: 価格(送料抜)
- **E列**: 価格(送料込)
- **F列**: 商品URL
- **G列**: サムネURL
- **H列**: レビュー数
- **I列**: レビュー平均
- **J列**: レビュー最新日
- **K列**: 直近3ヶ月のレビュー数
- **L列**: 直近3ヶ月のレビュー平均
- **M列**: 高評価レビュー
- **N列**: 中評価レビュー
- **O列**: 低評価レビュー

---

## ⚠️ 注意事項

### 1. スプレッドシートIDの形式

- 通常は44文字の英数字
- 例: `1wdH9PXo6cgzG258Dl_L4JmubYtSYe4V3ZruAim6KAOY`

### 2. 共有設定

- スプレッドシートは、Google Apps Scriptを実行するアカウントからアクセス可能である必要があります
- プライベートスプレッドシートの場合、スクリプトを実行するアカウントに共有する必要があります

### 3. データの上書き

- ワークフロー実行時、既存のデータ（B2:O300）はクリアされます
- 重要なデータがある場合は、バックアップを取ってください

---

## 🔄 複数のスプレッドシートを使い分ける

異なるプロジェクトで異なるスプレッドシートを使用する場合:

1. 各プロジェクトごとにスプレッドシートを作成
2. ワークフロー実行前に、設定画面でスプレッドシートIDを変更
3. または、ワークフローフォームで直接IDを入力

---

## 🆘 トラブルシューティング

### エラー: "スプレッドシートIDが見つかりません"

**原因**: IDが間違っている、またはアクセス権限がない

**対策**:
- スプレッドシートIDを再確認
- スプレッドシートが存在するか確認
- アクセス権限を確認

### エラー: "Sheet1が見つかりません"

**原因**: シート名が「Sheet1」ではない

**対策**:
- スプレッドシートのシート名を確認
- シート名を「Sheet1」に変更するか、コードを修正

### データが書き込まれない

**原因**: Google Apps ScriptのURLが設定されていない

**対策**:
- 設定画面で「Google Apps Script URL（書き込み用）」を設定
- Google Apps ScriptのWebアプリが正しく公開されているか確認

---

## 📚 関連ドキュメント

- `google-apps-script/README.md` - Google Apps Scriptの設定方法
- `VERCEL_SETUP.md` - Vercel Functionsの設定方法
- `DEPLOYMENT.md` - デプロイ手順

